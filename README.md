# Payroll Management System / –°–∏—Å—Ç–µ–º–∞ –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –†–æ–∑—Ä–∞—Ö—É–Ω–∫–∞–º–∏ –ó–∞—Ä–ø–ª–∞—Ç–∏

–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∞–º–∏ –∑–∞—Ä–æ–±—ñ—Ç–Ω–æ—ó –ø–ª–∞—Ç–∏ –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é —Å–∫–ª–∞–¥–Ω–∏—Ö –ø—Ä–∞–≤–∏–ª, workflow –∑–∞—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —Ç–∞ —ñ—Å—Ç–æ—Ä—ñ—ó –∑–º—ñ–Ω.

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### –ü–µ—Ä–µ–¥—É–º–æ–≤–∏

- Docker Desktop –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —ñ –∑–∞–ø—É—â–µ–Ω–æ
- Git
- Node.js 18+ (–¥–ª—è frontend —Ä–æ–∑—Ä–æ–±–∫–∏)
- Python 3.11+ (–¥–ª—è backend —Ä–æ–∑—Ä–æ–±–∫–∏)

### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

1. **–ö–ª–æ–Ω—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π** (–∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ —ñ—Å–Ω—É—é—á—É –ø–∞–ø–∫—É):
```bash
cd C:\Work\zarplata
```

2. **–°—Ç–≤–æ—Ä—ñ—Ç—å .env —Ñ–∞–π–ª** –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏:
```bash
copy .env.example .env
```

3. **–ó–∞–ø—É—Å—Ç—ñ—Ç—å –≤—Å—é —Å–∏—Å—Ç–µ–º—É —á–µ—Ä–µ–∑ Docker**:
```bash
docker-compose up -d
```

–¶–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å:
- PostgreSQL –Ω–∞ –ø–æ—Ä—Ç—É 5432
- Backend API –Ω–∞ –ø–æ—Ä—Ç—É 8000
- Frontend –Ω–∞ –ø–æ—Ä—Ç—É 3000

4. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ –≤—Å–µ –ø—Ä–∞—Ü—é—î**:
- Backend API: http://localhost:8000
- Frontend: http://localhost:3000
- API Docs: http://localhost:8000/docs

### –ü–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫ - –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å

–ü—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–æ–Ω–∞—é—Ç—å—Å—è:
1. –ú—ñ–≥—Ä–∞—Ü—ñ—ó Alembic (—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ç–∞–±–ª–∏—Ü—å)
2. Seed —Ç–µ—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö

–©–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î:
```bash
docker exec -it payroll_postgres psql -U admin -d payroll -c "\dt"
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ü—Ä–æ–µ–∫—Ç—É

```
zarplata/
‚îú‚îÄ‚îÄ backend/                    # FastAPI Backend
‚îÇ   ‚îú‚îÄ‚îÄ alembic/               # Database migrations
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ versions/          # Migration files
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ env.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ script.py.mako
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/               # API endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ endpoints/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ core/              # Core configuration
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ database.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/            # SQLAlchemy models
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ module1.py     # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —ñ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ module2.py     # –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ä–æ–±–æ—Ç–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ module3.py     # –ü–µ—Ä—ñ–æ–¥–∏ —ñ –Ω–∞—Ä–∞—Ö—É–≤–∞–Ω–Ω—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ module4.py     # –ü–ª–∞—Ç–µ–∂—ñ
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schemas/           # Pydantic schemas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/          # Business logic
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.py            # FastAPI app
‚îÇ   ‚îú‚îÄ‚îÄ alembic.ini
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ frontend/                   # React Frontend
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ App.jsx
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ database/                   # Database initialization
‚îÇ   ‚îî‚îÄ‚îÄ init/
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ .env
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ payroll_system_architecture.md
‚îî‚îÄ‚îÄ README.md
```

## üóÑÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –ë–∞–∑–∏ –î–∞–Ω–∏—Ö

–°–∏—Å—Ç–µ–º–∞ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ 4 –º–æ–¥—É–ª—ñ–≤:

### –ú–æ–¥—É–ª—å 1: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ü—ñ–¥–ø—Ä–∏—î–º—Å—Ç–≤–∞ —ñ –ü—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∏
- `organizational_units` - –û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π–Ω–∞ —ñ—î—Ä–∞—Ä—Ö—ñ—è (–¥–æ 6 —Ä—ñ–≤–Ω—ñ–≤)
- `employees` - –ü—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∏
- `contracts` - –ö–æ–Ω—Ç—Ä–∞–∫—Ç–∏ (salary, hourly, piecework, task_based)
- `calculation_rules` - –ü—Ä–∞–≤–∏–ª–∞ –Ω–∞—Ä–∞—Ö—É–≤–∞–Ω—å –∑ SQL –∫–æ–¥–æ–º
- `calculation_templates` - –®–∞–±–ª–æ–Ω–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤
- `template_rules` - –ó–≤'—è–∑–æ–∫ —à–∞–±–ª–æ–Ω—ñ–≤ —ñ –ø—Ä–∞–≤–∏–ª

### –ú–æ–¥—É–ª—å 2: –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –†–æ–±–æ—Ç–∏
- `work_results` - –ó–∞–≥–∞–ª—å–Ω–∞ —Ç–∞–±–ª–∏—Ü—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
- `timesheets` - –¢–∞–±–µ–ª—å –æ–±–ª—ñ–∫—É —á–∞—Å—É
- `production_results` - –í–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ

### –ú–æ–¥—É–ª—å 3: –ü–µ—Ä—ñ–æ–¥–∏ —Ç–∞ –ù–∞—Ä–∞—Ö—É–≤–∞–Ω–Ω—è
- `calculation_periods` - –†–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–≤—ñ –ø–µ—Ä—ñ–æ–¥–∏
- `accrual_documents` - –î–æ–∫—É–º–µ–Ω—Ç–∏ –Ω–∞—Ä–∞—Ö—É–≤–∞–Ω—å
- `accrual_results` - –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ (immutable)
- `change_requests` - –ó–∞–ø–∏—Ç–∏ –Ω–∞ –∑–º—ñ–Ω–∏

### –ú–æ–¥—É–ª—å 4: –ü–ª–∞—Ç–µ–∂—ñ
- `payment_rules` - –ü—Ä–∞–≤–∏–ª–∞ —Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—è –ø–ª–∞—Ç–µ–∂—ñ–≤
- `payment_documents` - –î–æ–∫—É–º–µ–Ω—Ç–∏ –ø–ª–∞—Ç–µ–∂—ñ–≤
- `payment_items` - –ü–æ–∑–∏—Ü—ñ—ó –ø–ª–∞—Ç–µ–∂—ñ–≤
- `bank_statements` - –ë–∞–Ω–∫—ñ–≤—Å—å–∫—ñ –≤—ñ–¥–æ–º–æ—Å—Ç—ñ

## üîß –†–æ–∑—Ä–æ–±–∫–∞

### Backend

**–õ–æ–∫–∞–ª—å–Ω–∞ —Ä–æ–∑—Ä–æ–±–∫–∞ –±–µ–∑ Docker:**

```bash
cd backend

# –°—Ç–≤–æ—Ä–∏—Ç–∏ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ
python -m venv venv
venv\Scripts\activate

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
pip install -r requirements.txt

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä
uvicorn app.main:app --reload
```

**–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ—ó –º—ñ–≥—Ä–∞—Ü—ñ—ó:**

```bash
cd backend
alembic revision --autogenerate -m "Description of changes"
alembic upgrade head
```

**–í—ñ–¥–∫–∞—Ç –º—ñ–≥—Ä–∞—Ü—ñ—ó:**

```bash
alembic downgrade -1
```

### Frontend

**–õ–æ–∫–∞–ª—å–Ω–∞ —Ä–æ–∑—Ä–æ–±–∫–∞:**

```bash
cd frontend

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
npm install

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ dev server
npm start
```

## üìä API Endpoints

### –ü—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∏
- `GET /api/v1/employees` - –°–ø–∏—Å–æ–∫ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤
- `POST /api/v1/employees` - –°—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞
- `GET /api/v1/employees/{id}` - –î–µ—Ç–∞–ª—ñ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞

### –ü–µ—Ä—ñ–æ–¥–∏
- `GET /api/v1/periods` - –°–ø–∏—Å–æ–∫ –ø–µ—Ä—ñ–æ–¥—ñ–≤
- `POST /api/v1/periods` - –°—Ç–≤–æ—Ä–∏—Ç–∏ –ø–µ—Ä—ñ–æ–¥
- `GET /api/v1/periods/{id}` - –î–µ—Ç–∞–ª—ñ –ø–µ—Ä—ñ–æ–¥—É

### –†–æ–∑—Ä–∞—Ö—É–Ω–∫–∏
- `POST /api/v1/calculations/run` - –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫
- `GET /api/v1/calculations/{id}` - –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É

–ü–æ–≤–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è: http://localhost:8000/docs

## üéØ –ö–ª—é—á–æ–≤—ñ –ü—Ä–∏–Ω—Ü–∏–ø–∏

### 1. Immutability (–ù–µ–∑–º—ñ–Ω–Ω—ñ—Å—Ç—å)
- –î–∞–Ω—ñ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –≤–∏–¥–∞–ª—è—é—Ç—å—Å—è
- –ó–º—ñ–Ω–∏ —á–µ—Ä–µ–∑ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ + —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è —Å—Ç–∞—Ä–æ–≥–æ
- –ü–æ–≤–Ω–∞ —ñ—Å—Ç–æ—Ä—ñ—è

### 2. Workflow
–î–æ–∫—É–º–µ–Ω—Ç–∏ –º–∞—é—Ç—å —Å—Ç–∞—Ç—É—Å–∏:
- `draft` - —á–µ—Ä–Ω–µ—Ç–∫–∞
- `in_review` - –Ω–∞ —Ä–æ–∑–≥–ª—è–¥—ñ
- `approved` - –∑–∞—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ
- `cancelled` - —Å–∫–∞—Å–æ–≤–∞–Ω–æ

### 3. –Ü—î—Ä–∞—Ä—Ö—ñ—è –ü—Ä–∞–≤–∏–ª
- –ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–≤'—è–∑–∞–Ω—ñ –¥–æ —Ä—ñ–≤–Ω—ñ–≤ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π–Ω–æ—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏
- –£—Å–ø–∞–¥–∫—É–≤–∞–Ω–Ω—è –≤—ñ–¥ –≤–∏—â–∏—Ö —Ä—ñ–≤–Ω—ñ–≤ –¥–æ –Ω–∏–∂—á–∏—Ö
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø–µ—Ä–µ–≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞ –∫–æ–∂–Ω–æ–º—É —Ä—ñ–≤–Ω—ñ

### 4. –ü–æ—Å–ª—ñ–¥–æ–≤–Ω–µ –í–∏–∫–æ–Ω–∞–Ω–Ω—è
- –ü—Ä–∞–≤–∏–ª–∞ –≤ —à–∞–±–ª–æ–Ω—ñ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –ø–æ —á–µ—Ä–∑—ñ
- –ö–æ–∂–Ω–µ –ø—Ä–∞–≤–∏–ª–æ –±–∞—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö
- –ü–æ—Ä—è–¥–æ–∫ –∫—Ä–∏—Ç–∏—á–Ω–∏–π

## üîê –ë–µ–∑–ø–µ–∫–∞

- –í—Å—ñ SQL –ø—Ä–∞–≤–∏–ª–∞ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è —á–µ—Ä–µ–∑ prepared statements
- –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è –æ–∫—Ä–µ–º–æ
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è –ø–µ—Ä–µ–¥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è–º
- –ê—É–¥–∏—Ç –≤—Å—ñ—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π (created_by, updated_by)

## üìù –¢–µ—Å—Ç–æ–≤—ñ –î–∞–Ω—ñ

–ü—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è:
- 10 –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤
- 12 –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π–Ω–∏—Ö –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—ñ–≤
- 3 –ø—Ä–∞–≤–∏–ª–∞ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤:
  - BASE_SALARY - –û—Å–Ω–æ–≤–Ω–∞ –∑–∞—Ä–ø–ª–∞—Ç–∞
  - PIT - –ü–î–§–û 18%
  - WAR_TAX - –í—ñ–π—Å—å–∫–æ–≤–∏–π –∑–±—ñ—Ä 1.5%
- 1 —à–∞–±–ª–æ–Ω: MONTHLY_SALARY

## üõ†Ô∏è –ö–æ—Ä–∏—Å–Ω—ñ –ö–æ–º–∞–Ω–¥–∏

**–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å—ñ—î—ó —Å–∏—Å—Ç–µ–º–∏:**
```bash
docker-compose restart
```

**–ü–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤:**
```bash
docker-compose logs -f backend
docker-compose logs -f postgres
```

**–ó—É–ø–∏–Ω–∫–∞ —Å–∏—Å—Ç–µ–º–∏:**
```bash
docker-compose down
```

**–ü–æ–≤–Ω–µ –æ—á–∏—â–µ–Ω–Ω—è (–≤–∫–ª—é—á–Ω–æ –∑ –¥–∞–Ω–∏–º–∏):**
```bash
docker-compose down -v
```

**–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ PostgreSQL:**
```bash
docker exec -it payroll_postgres psql -U admin -d payroll
```

## üìö –î–æ–¥–∞—Ç–∫–æ–≤–∞ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

- [–ü–æ–≤–Ω–∞ –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞](./payroll_system_architecture.md)
- [API Documentation](http://localhost:8000/docs)
- [ReDoc](http://localhost:8000/redoc)

## üêõ Troubleshooting

**–ü–æ—Ä—Ç 5432 –∑–∞–π–Ω—è—Ç–∏–π:**
```bash
# –ó–º—ñ–Ω—ñ—Ç—å –ø–æ—Ä—Ç –≤ docker-compose.yml
ports:
  - "5433:5432"  # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ —ñ–Ω—à–∏–π –ø–æ—Ä—Ç
```

**Backend –Ω–µ –ø—ñ–¥–∫–ª—é—á–∞—î—Ç—å—Å—è –¥–æ –ë–î:**
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ –∑–∞–ø—É—â–µ–Ω–æ PostgreSQL
docker ps | grep postgres

# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏
docker logs payroll_postgres
```

**Frontend –Ω–µ –±–∞—á–∏—Ç—å Backend:**
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ Backend –∑–∞–ø—É—â–µ–Ω–æ: http://localhost:8000/health
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ REACT_APP_API_URL –≤ .env

## üìÑ –õ—ñ—Ü–µ–Ω–∑—ñ—è

[–í–∫–∞–∂—ñ—Ç—å –ª—ñ—Ü–µ–Ω–∑—ñ—é]

## üë• –ê–≤—Ç–æ—Ä–∏

[–í–∞—à–µ —ñ–º'—è]
